import base64
import zlib
import json
import enum
import matplotlib
import matplotlib.pyplot as plt
import matplotlib.patches as patches


matplotlib.rc('font', size=6.5)

bp_str = "0eNqVlNFugzAMRf/Fz0GCwOjKr0zTFFKvtQQGJWFaVeXfF+hDq2205gmFkONjFN8LtN2EoyMO0FyA7MAemrcLeDqy6eZ34TwiNEABe1DApp9XwRn24+BC1mIXICogPuA3NEVUTw8b77FvO+Jj1ht7IsasvEPo+K4AOVAgvMosi/MHT32LLtVY01AwDj4dG3iunVCZVnBOjzLRD+TQXvf0LPkLqjdD9XNoKYcWYtNqM1Rg+iKGypn1Vqag+Z2YmYuZr1uZgt73Yqb8NhX5Vqig+eI2TZ/Gh4zYowtpZ/U2FfE/jH483iu/MsUFJD1aUgK7JOoGJptZcnaiOVj+VroNVTekGieTYuPwwDt/pF1Ju79SyjiH0xJnzV10KvhC55eP66rSdV7Uu3of4w9eGcpu"
bp_str = "0eNqVl+1ugjAUhu+lvyGhHxTlVpZlAexcEyimrcuM4d5XZNncdPieXwaBp89peaHnzNr+aA7eusjqM7Pd6AKrn84s2L1r+vm/eDoYVjMbzcAy5pphPmpCMEPbW7fPh6Z7s87kkk0Zs25nPljNp+whIvrGhcPoY96aPl7dLKbnjBkXbbRmkbkcnF7ccWiNT/R1jYwdxpBuHt08dgLmImOn9KOmWesPTBBhfIUlv1mvTYi5dcH4mE7cGsmFIlLVO+tNt5xTd5gKZRYwsoQ1OczU/63rLXSzQPlvqLgDrajQ4jFzgzM1ytxSmUjxvMCpFU7lVCpQPxc4VOGqEqeWsKqiqiLQkmoK1U/IlIBVCZmSMHRDNYXq31JVEarAY1XgUE6EApMqCKHiMFRSoVD5eKjw5Rd4qAimmmiKzGlFFEWYeKLglAo8T/CbTxZEJrJIkhOLh6B4nODvvsTTBH+gpCJ6QsWXRFEIimcJ3p1JPEvw7kRuiJ5Q8VuiKAJVBbwzX0z5vS5EkfujxVAmwaRnL72a6ZOoH53t8s767mjnDu12qJ9Q9WMa5K1JLdxuzbta8ZZEGP9iPe6h4CZKr+iVRL1yhaWJS7R43W06VQU/NMvkl9PcYF+a8fqq/c/Yu/HhcrVWSuiC60pvp+kTqdNeZw=="
#bp_str = "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"

class Directions(enum.Enum):
    UP = 0
    RIGHT = 2
    DOWN = 4
    LEFT = 6

def plot_entities(entities, assemb=False, **kwargs):

    xs, ys = [], []
    for ent in entities:
        print("NAME", ent["name"])
        x = ent["position"]["x"]
        y = ent["position"]["y"]

        name = ent["name"]
        plt.annotate(name, xy=(x, y), xytext=(x, y))


        if assemb:
            x+=.5
            y+=.5

        xs.append(x)
        ys.append(y)


    plt.scatter(xs, ys, **kwargs)
    plt.xticks(list(range(-10, 10)))
    plt.yticks(list(range(-10, 10)))



def decode_bp(bp_str):
    bp_dict = json.loads(zlib.decompress(base64.b64decode(bp_str[1:])).decode("utf-8"))
    for ent in bp_dict["blueprint"]["entities"]:
        ent["position"]["y"] *= -1
    return bp_dict


def find_inserters_to_assembler(entities, assembler):
    assembler_x_rng = list(range(assembler["position"]["x"]-1, assembler["position"]["x"]+2))
    assembler_y_rng = list(range(assembler["position"]["y"]-1, assembler["position"]["y"]+2))

    print("XRANGE", assembler_x_rng)
    print("YRANGE", assembler_y_rng)

    for ent in entities:
        if not "inserter" in ent["name"]:
            continue
        if "direction" not in ent:
            ent["direction"] = Directions.UP #WTF

        x, y = ent["position"]["x"], ent["position"]["y"]
        mv_dist = 2 if ent["name"].startswith("long") else 1

        distance_vectors = {
            Directions.UP : (0, -mv_dist),
            Directions.LEFT : (mv_dist, 0),
            Directions.DOWN : (0, mv_dist),
            Directions.RIGHT : (-mv_dist, 0)
        }


        this_dir = Directions(ent["direction"])

        delta_vector = distance_vectors[this_dir]
        output_pos = x + delta_vector[0], y + delta_vector[1]

        print(ent["name"], ent["direction"], output_pos, "vec", delta_vector)

        if output_pos[0] in assembler_x_rng and output_pos[1] in assembler_y_rng:
            yield ent


def reduce_slightly(dist):
    if dist == 0: return 0
    reducer_const = 0.4
    sign = -1 if dist < 0 else 1
    return sign * (abs(dist) - reducer_const)







bp_dict = decode_bp(bp_str)
#print(json.dumps(bp_dict, indent=3))

entities = bp_dict["blueprint"]["entities"]

assemblers = [ent for ent in entities if ent["name"] == "assembling-machine-3"]

print(assemblers)


fig,ax = plt.subplots(1)

for assembler in assemblers:

    inserters = list(find_inserters_to_assembler(entities, assembler))

    ass_x, ass_y = assembler["position"]["x"], assembler["position"]["y"]
    patch = patches.Rectangle((ass_x-1, ass_y-1), 3, 3, alpha=0.3)
    ax.add_patch(patch)

    for inserter in inserters:
        ins_x, ins_y = inserter["position"]["x"], inserter["position"]["y"]

        spacing = 0.3
        ax.arrow(inserter["position"]["x"], inserter["position"]["y"], (ass_x-ins_x), (ass_y-ins_y), head_width=.3)
    plot_entities(inserters)
    plot_entities(assemblers, color="red", assemb=True)
    print(inserters)
plt.show()

